test_case(name => "print",
  source => "print(10);",
  expect => "10"
);

test_case(name => "add",
  source => "print(10 + 10 + 10);",
  expect => "30"
);

test_case(name => "sub",
  source => "print(200 - 10 - 10);",
  expect => "180"
);

test_case(name => "umul",
  source => "print(10 * 10 * 10);",
  expect => "1000"
);

test_case(name => "smul",
  source => "print(10 * 10 * -10);",
  expect => "-1000"
);

test_case(name => "udiv",
  source => "print(128 / 2 / 4);",
  expect => "16"
);

test_case(name => "sdiv",
  source => "print(128 / 2 / -4);",
  expect => "-16"
);

test_case(name => "cmp_slt",
  source => "print(1 < 1); print(1 < -1); print(1 < 2); print(-2 < -1);",
  expect => "0\n0\n1\n1"
);

test_case(name => "cmp_sgt",
  source => "print(1 > 1); print(-1 > 1); print(2 > 1); print(-1 > -2);",
  expect => "0\n0\n1\n1"
);

test_case(name => "cmp_sle",
  source => "print(1 <= 1); print(1 <= 2); print(-1 <= -2); print(-2 <= -2);",
  expect => "1\n1\n0\n1"
);

test_case(name => "cmp_sge",
  source => "print(1 >= 1); print(2 >= 1); print(-2 >= -1); print(-2 >= -2);",
  expect => "1\n1\n0\n1"
);

test_case(name => "cmp_ult",
  source =>
    "print(uint(1) < uint(1));" .
    "print(uint(1) < uint(-1));" .
    "print(uint(1) < uint(2));".
    "print(uint(-2) < uint(-1));",
  expect => "0\n1\n1\n1"
);

test_case(name => "cmp_ugt",
  source =>
    "print(uint(1) > uint(1));" .
    "print(uint(-1) > uint(1));" .
    "print(uint(2) > uint(1));".
    "print(uint(-1) > uint(-2));",
  expect => "0\n1\n1\n1"
);

test_case(name => "cmp_ule",
  source =>
    "print(uint(1) <= uint(1));" .
    "print(uint(1) <= uint(2));" .
    "print(uint(1) <= uint(0));" .
    "print(uint(1) <= uint(-1));",
  expect => "1\n1\n0\n1"
);

test_case(name => "cmp_uge",
  source =>
    "print(uint(1) >= uint(1));" .
    "print(uint(2) >= uint(1));" .
    "print(uint(0) >= uint(1));" .
    "print(uint(-1) >= uint(1));",
  expect => "1\n1\n0\n1"
);

test_case(name => "shift_left",
  source => "print(1 << 10);",
  expect => "1024"
);

test_case(name => "shift_right",
  source => "print(1024 >> 4);",
  expect => "64"
);

test_case(name => "arithm_shift_right",
  source => "print(-1 >> 4);",
  expect => "-1"
);

test_case(name => "logical_shift_right",
  source => "print(uint16(-1) >> uint16(4));",
  expect => 0xfff
);

test_case(name => "arithm_expr",
  source => "print(2 + 2 * 2);",
  expect => "6"
);

test_case(name => "cast_uint8",
  source => "print(uint8(0xdeadbeaf));",
  expect => 0xaf
);

test_case(name => "cast_uint16",
  source => "print(uint16(0xdeadbeaf));",
  expect => 0xbeaf
);

test_case(name => "cast_uint_twice",
  source => "print(uint32(uint64(0xdeadbeaf)));",
  expect => 0xdeadbeaf
);

test_case(name => "cast_int8",
  source => "print(int8(0xffffffff));",
  expect => "-1"
);

test_case(name => "cast_int16",
  source => "print(int16(0xffffffff));",
  expect => "-1"
);

test_case(name => "cast_int_twice",
  source => "print(int32(int64(0xffffffff)));",
  expect => "-1"
);

test_case(name => "multiline",
  source => "print(1); print(2); print(3);",
  expect => "1\n2\n3"
);

test_case(name => "identifiers",
  source => "let x=5; let y = 7; print(x * y - x + y);",
  expect => "37"
);

